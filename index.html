<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <title>Code for America Brigade</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Locals helping Mesa open their data and create meaningful web and mobile apps">
    <link rel="shortcut icon" href="favicon.ico" />
    <link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.0/css/bootstrap-combined.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
    <script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.0/js/bootstrap.min.js"></script>
    
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>

  <body>

    <!-- NAVBAR
    ================================================== -->
    <div class="navbar-wrapper">

      <!-- Wrap the .navbar in .container to center it within the absolutely positioned parent. -->
      <div class="container">

        <div class="navbar navbar-inverse">
          <div class="navbar-inner">

            <!-- Responsive Navbar Part 1: Button for triggering responsive navbar. Include responsive CSS to utilize. -->
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </a>
            <a class="brand" href="#"><span class="c4mred">Code</span> <span class="c4mwhite">for</span> <span class="c4mblue">Mesa</span></a>

            <!-- Responsive Navbar Part 2: Place all navbar contents you want collapsed withing .navbar-collapse.collapse. -->
            <div class="nav-collapse collapse">
              <ul class="nav">
                <li class="active"><a href="/">Home</a></li>
                <li><a href="http://mesanaround.tumblr.com/" target="_blank">Blog</a></li>

                <!-- Read about Bootstrap dropdowns at http://twitter.github.com/bootstrap/javascript.html#dropdowns -->

                <li class="dropdown" id="menu-projects">
                  <a href="#menu-projects" class="dropdown-toggle" data-toggle="dropdown">
                    Projects
                    <b class="caret"></b>
                  </a>
                  <ul class="dropdown-menu">
                    <li>
                      <a href="https://github.com/codeformesa">
                        <i class="icon-wrench"></i>
                        Project Code on GitHub</a>
                    </li>
                    <li>
                      <a href="#">
                      <i class="icon-pencil"></i>
                      Idea List for Apps & Open Data</a>
                    </li>
                  </ul>
                </li>

                <li class="dropdown" id="menu-contact">
                  <a href="#menu-contact" class="dropdown-toggle" data-toggle="dropdown">Contact Us
                  <b class="caret"></b>
                  </a>
                  <ul class="dropdown-menu">
                    <li>
                      <a href="https://groups.google.com/forum/#!forum/cfa-phx" target="_blank">
                      <i class="icon-comment"></i>
                      Google Groups</a>
                    </li>
                    <li>
                      <a href="#">
                      <i class="icon-thumbs-up"></i>
                      Facebook Page</a>
                    </li>
                    <li>
                      <a href="https://twitter.com/CodeForPHX" target="_blank">
                        <i class="icon-comment"></i>
                        Tweet @ Us</a></a>
                    </li>

                    <li class="divider"></li>

                    <li>
                      <a href="https://twitter.com/search?q=%23cfabrigade" target="_blank">
                      <i class="icon-retweet"></i>
                      National Tweets</a>
                    </li>
                  </ul>
                </li>
           </ul>
           <ul class="nav pull-right language-menu">
            <li class="divider-vertical"></li>
            <li>
              <a class="brand" href="#"><span class="c4mred">Codigo</span> <span class="c4mwhite">para</span> <span class="c4mblue">Mesa</span></a>
            </li>
               </ul>
            </div><!--/.nav-collapse -->
          </div><!-- /.navbar-inner -->
        </div><!-- /.navbar -->

      </div> <!-- /.container -->
    </div><!-- /.navbar-wrapper -->


  <!-- fork me banner, top right
  ================================================== -->
<!--
  <a class="forkme" href="https://github.com/c4hrva/c4hrva-landing"><img style="position: absolute; top: 0; right: 0; border: 0; z-index: 100;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"></a>
-->


    <!-- Carousel - only using one at the moment
    ================================================== -->
    <div class="carousel slide">
      <div class="carousel-inner">

        <div class="item active">
          <img src="images/carousel/Miami1.jpg" alt="American Airlines Arena | Downtown Miami" />
          <div class="container">
            <div class="carousel-caption">
              <h1>Join the Movement</h1>
              <p class="lead">
                We are looking for creatives, developers, designers and writers to support our movement.
              </p>
              <a class="btn btn-large btn-danger" href="http://codeforamerica.org/cities/mesa/" target="_blank">About Us</a>
            </div>
          </div>
        </div>

        <div class="item">
          <img src="images/carousel/Miami2.jpg" alt="MacArthur Causeway | Miami" />
          <div class="container">
            <div class="carousel-caption">
              <h1>We Are Code for Mesa</h1>
              <p class="lead">
                Come join developers, designers, data geeks, leaders, and idea-makers who 
                volunteer to help City of Mesa and civic organizations adopt open web technologies.
              </p>
              <a class="btn btn-large btn-danger" href="http://www.meetup.com/CodeForPHX/" target="_blank">Find a Meetup</a>
            </div>
          </div>
        </div>

        <div class="item">
          <img src="images/carousel/Miami3.jpg" alt="Downtown Miami Skyline" />
          <div class="container">
            <div class="carousel-caption">
              <h1>Want to Learn More?</h1>
              <p class="lead">
                We meet monthly.
              </p>
              <a class="btn btn-large btn-danger" href="http://www.meetup.com/CodeForPHX/" target="_blank">Find a Meetup</a>
            </div>
          </div>
        </div>

      </div>
    </div><!-- /.carousel -->

    <div class="container marketing clearleft">


    <!-- Marketing messaging and featurettes
    ================================================== -->
    <!-- Wrap the rest of the page in another container to center all the content. -->



      <!-- START THE FEATURETTES -->

      <div class="featurette">
        <a href="http://www.meetup.com/CodeForPHX/">
          <img name ="meetup" id="meetup" class="featurette-image pull-left" src="images/meetup.jpg" alt="Meetup dot com" target="_blank"></a>
          <h2 class="featurette-heading">We meet monthly. <span class="muted">Come join us.</span></h2>
          <p class="lead">Check out <a href="http://www.meetup.com/CodeForPHX/">our Meetup</a> to learn more about our events and projects.</p>
      </div>

      <hr class="featurette-divider">

      <div class="featurette">
        <a href="http://brigade.codeforamerica.org/">
          <img name="cfa" id="cfa" class="featurette-image pull-right" src="images/cfa_brigade_logo.png" alt="Code for America Brigade" />
        </a>
        <h2 class="featurette-heading">Want To Help Your City? <span class="muted">Good, we could use your help.</span></h2>
        <p class="lead">We are a <a href="http://brigade.codeforamerica.org/">Code for America Brigade</a>,
          which means we're volunteers that contribute
          our talents toward improving the way our local governments and community organizations use the web.
          Brigade is about action and you're here because you are someone who takes action. Watch the 
          <a href="http://codeforamerica.org/2012/03/08/jennifer-pahlka-at-ted-video/" target="_blank">inspirational TED talk given by Jennifer Pahlka, the founder of Code for America.</a></p>
      </div>

      <hr class="featurette-divider">

      <div class="featurette">
        <img class="featurette-image pull-left" style="padding-bottom: 50px" src="images/noun_project_756_citizen.png" alt="Citizen" />
        <h2 class="featurette-heading">Works In Progress. <br/><span class="muted">Some Of Our Projects.</span></h2>
        <p class="lead">
          <div class="span4">
            <ul class="lead" style="list-style-type: none; padding-left:0; text-align: left;">  
              <li>
                # something here (<a href="#">demo</a>)
              </li>
            </ul>
          </div>
        </p>
      </div>

      <hr class="featurette-divider">

      <!-- /END THE FEATURETTES -->


      <!-- FOOTER -->
      <footer>
        <p class="pull-right"><a href="#">Back to top</a></p>
        <p>...People trying to make Mesa even better...</p>
        <p>Built and maintained by Code for Mesa volunteers. Site design based on <a href="http://twitter.github.com/bootstrap">Bootstrap</a>, Some images provided by <a href="#"># something here</a>.</p>
      </footer>

    </div><!-- /.container -->
  </body>
<script src="js/bootstrap-tooltip.js"></script>

<script>    

  $(document).ready(function(){ 
  
    $('.carousel').carousel({
      interval: 5000
    })

    //GLOBAL VARIABLES HERE//
  var apiKey = "2975b6e4c43147824522959761677",
    meetupGroupUrl = "http://meetup.com/CodeForPHX";

  var memberList = new Array();
   
    //get the next event
    $.getJSON("http://api.meetup.com/2/events?status=upcoming&order=time&limited_events=False&group_urlname=Code-For-Miami&desc=false&offset=0&format=json&page=20&fields=&sig_id=14485765&sig=ee64791e1ab7c9e6f82c5f5e47c85118fa698fd6&callback=?",function(upcomingData) { 

    eventTime = upcomingData.results[0].time;
      
    //currentTime = eventTime + 1 //testing value
    currentTime = new Date().getTime();
    eventEndTime = eventTime + 60000*60*3;
    //eventEndTime = eventTime + upcomingData.results[0].duration;
    //the above line only works if a specific end time is set.

    //console.log("Current Time is " + currentTime)
    //console.log("Event End Time is " + eventEndTime);
    eventId = upcomingData.results[0].id;

    if (currentTime >= eventTime && currentTime < eventEndTime) { 
      //console.log("Time to rock!");
        
      var memberbox = "<div class='memberbox'></div>";
      $(".carousel-caption").append(memberbox);
      //$(".memberbox").hide();

      //testing value for eventId
      //eventId = "113850802";

    function showThumbnails() {
      
      //get the checkin data for the next event
      $.getJSON("https://api.meetup.com/2/checkins?key="+apiKey+"&sign=true&event_id="+eventId+"&page=20&callback=?",function(checkinData) {

          howMany = checkinData.meta.count;

          //if there's nobody checked in, there's nothing to see here.  
          if (howMany === 0) {

            console.log("Nobody is checked in yet.");

            $(".memberbox").html("<h2>Nobody has checked in yet.</h2>");
            $(".memberbox").slideDown();
            

          //else, let's get those thumbnails up and running.  
          } else if (howMany >= 1) {

            $.each(checkinData.results, function(i,checkinData) {

              //console.log(checkinData.member_id);

              $.getJSON("https://api.meetup.com/2/member/"+checkinData.member_id+"?key="+apiKey+"&&sign=true&page=20&callback=?", function(memberData) { 
                  
                  var memberName = memberData.name,
                      toolTips = "<a class='tip' href='#' data-toggle='tooltip' data-placement='bottom' data-original-title='"+memberData.name+"'>", 
                      memberPix  = memberData.photo.thumb_link,
                      memberThumb = toolTips +"<img class='pix-thumb' src='"+memberPix+"' alt='"+ memberData.name +"'/></a>";
                  
                  if (memberList.indexOf(memberName) === -1) {
                      
                      memberList.push(memberName);
                      $(memberThumb).appendTo($(".memberbox"));

                  } else {
                    //do nothing
                  } 
                                    
                  $('.tip').tooltip();

              });

            });

            //event information  
            $.getJSON("https://api.meetup.com/2/events?key="+apiKey+"&sign=true&event_id="+eventId+"&page=20&callback=?", function(eventData) { 

                var eventName = eventData.results[0].name,
                  eventLocation = eventData.results[0].venue.name,
                  eventStAddress = eventData.results[0].venue.address_1,
                  eventCity = eventData.results[0].venue.city,
                  eventState = eventData.results[0].venue.state,
                  eventURL = eventData.results[0].event_url,
                  memberCount = memberList.length,
                  eventCheckin = "<p id='checkins'>"+memberCount+" Civic Hackers are checked in at <a href='http://maps.google.com/maps?q="+eventStAddress+" "+eventCity+" "+eventState+"'>"+eventLocation+"</a> for <a href='"+eventURL+"'>"+eventName+"</a>.</p>";

                console.log(memberCount);

              $(window).load(function(){

                $(eventCheckin).appendTo($(".memberbox"));
                $(".memberbox").slideDown();

              });

            });            
            
          }

        });
    
    }

    showThumbnails();



    } else {
      console.log("Nothing to see here.");
    }

    });

  });

</script>
</html>